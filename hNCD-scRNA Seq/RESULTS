0
1
2
3
4
kmeans half7 0.25
[0.13472222 0.16388889 0.10416667 0.14027778 0.09444444 0.52083333
 0.60029451 0.        ]
[0.06966631 0.0531783  0.00760726 0.05185599 0.02307396 0.02777778
 0.03315955 0.        ]
0
1
2
3
4
GMM half7 0.25
[0.14722222 0.2125     0.19861111 0.19444444 0.15833333 0.6
 0.67186356 0.        ]
[0.12007264 0.08568443 0.0622061  0.08936504 0.04878936 0.03061862
 0.04329796 0.        ]
0
1
2
3
4
hmodel half7 0.25
[0.60277778 0.275      0.31527778 0.54861111 0.45       0.625
 0.66537551 0.         0.61111111 0.28194444 0.31666667 0.55694444
 0.45833333 0.63472222 0.66855672 0.        ]
[0.04175916 0.09156139 0.14235942 0.02946278 0.06752914 0.0359505
 0.01696998 0.         0.05121969 0.09885533 0.14457793 0.0401098
 0.0569275  0.04203541 0.01375028 0.        ]
0
1
2
3
4
kmeans half7 0.5
[0.03333333 0.10138889 0.08611111 0.14166667 0.10833333 0.43263889
 0.60152329 0.        ]
[0.01194767 0.04104866 0.03875224 0.0334777  0.01993431 0.04498371
 0.04423967 0.        ]
0
1
2
3
4
GMM half7 0.5
[0.03819444 0.11388889 0.09861111 0.11736111 0.09236111 0.47916667
 0.63462029 0.        ]
[0.02616867 0.05430005 0.07155137 0.04497299 0.04028975 0.04446614
 0.03894794 0.        ]
0
1
2
3
4
hmodel half7 0.5
[0.29722222 0.16736111 0.11180556 0.24305556 0.11805556 0.38402778
 0.59283217 0.         0.29513889 0.18611111 0.09513889 0.24513889
 0.10625    0.38333333 0.59484747 0.        ]
[0.05601374 0.04737516 0.05142641 0.0845969  0.05233734 0.06597588
 0.0380496  0.         0.06686169 0.07523113 0.04646036 0.08138936
 0.05588444 0.06752914 0.03947625 0.        ]
0
1
2
3
4
kmeans binary4 0.25
[0.15357143 0.12142857 0.14285714 0.23571429 0.15       0.57142857
 0.61298517 0.        ]
[0.0803373  0.1        0.08820778 0.08992627 0.08112726 0.07319251
 0.07534118 0.        ]
0
1
2
3
4
GMM binary4 0.25
[0.10357143 0.18214286 0.24285714 0.26785714 0.24285714 0.67142857
 0.72269353 0.        ]
[0.08406144 0.1574672  0.09622995 0.07405872 0.04601464 0.07542397
 0.06672496 0.        ]
0
1
2
3
4
hmodel binary4 0.25
[0.62142857 0.55714286 0.4        0.53214286 0.55       0.65714286
 0.69929108 0.         0.58214286 0.52142857 0.38928571 0.53928571
 0.49642857 0.63928571 0.70317294 0.        ]
[0.0993602  0.16955825 0.19052827 0.20184102 0.17692094 0.06624013
 0.07934799 0.         0.09216777 0.20247197 0.16459598 0.23238998
 0.14785887 0.08096989 0.07007881 0.        ]
0
1
2
3
4
kmeans binary4 0.5
[0.08666667 0.11833333 0.12666667 0.23166667 0.11166667 0.43
 0.59810889 0.        ]
[0.05416026 0.0707892  0.05661763 0.0399305  0.02915476 0.0227303
 0.03571891 0.        ]
0
1
2
3
4
GMM binary4 0.5
[0.06333333 0.10166667 0.11666667 0.19166667 0.105      0.49
 0.65980644 0.        ]
[0.0509902  0.04983305 0.05027701 0.0529675  0.05930149 0.04636809
 0.02720604 0.        ]
0
1
2
3
4
hmodel binary4 0.5
[0.36166667 0.21833333 0.18333333 0.32166667 0.255      0.46833333
 0.6414072  0.         0.36       0.22       0.155      0.30666667
 0.23166667 0.47333333 0.64389782 0.        ]
[0.05976807 0.10074721 0.03535534 0.12699519 0.09896689 0.05436502
 0.04368668 0.         0.07291548 0.07720823 0.06381397 0.12509996
 0.14185282 0.03349959 0.03647258 0.        ]
0
1
2
3
4
kmeans Paul 0.25
[0.22691353 0.05549284 0.05099846 0.21580394 0.0936269  0.7550813
 0.72399624 0.        ]
[0.13954513 0.08839422 0.09050499 0.12379485 0.10830281 0.14632939
 0.15151558 0.        ]
0
1
2
3
4
GMM Paul 0.25
[0.07225667 0.09171979 0.16587709 0.20706404 0.21547727 0.7247133
 0.69552167 0.        ]
[0.05029465 0.08943455 0.22668912 0.15274898 0.08418818 0.12667715
 0.12393864 0.        ]
0
1
2
3
4
hmodel Paul 0.25
[0.09699733 0.12348878 0.12348878 0.16745481 0.14919415 0.63067554
 0.52111204 0.         0.18763535 0.07890898 0.07890898 0.20388556
 0.23894303 0.6084437  0.50178508 0.        ]
[0.1649194  0.12806468 0.12806468 0.16939341 0.14768833 0.15184396
 0.12693011 0.         0.165478   0.09829598 0.09829598 0.11469941
 0.13918449 0.17951004 0.18925173 0.        ]
0
1
2
3
4
kmeans Paul 0.5
[0.06970832 0.07239564 0.07427529 0.10597617 0.05041961 0.64330416
 0.6923899  0.        ]
[0.06349498 0.08548201 0.08483267 0.17845534 0.08203303 0.03654259
 0.03090919 0.        ]
0
1
2
3
4
GMM Paul 0.5
[0.15864616 0.07482754 0.05631245 0.05899284 0.06781305 0.66378647
 0.69393738 0.        ]
[0.06237371 0.10454538 0.06779063 0.04796901 0.04562053 0.06486452
 0.05034025 0.        ]
0
1
2
3
4
hmodel Paul 0.5
[0.03735749 0.09810778 0.06879985 0.02024678 0.07503497 0.66310685
 0.67494631 0.         0.14077058 0.07832299 0.15435786 0.08398954
 0.05840441 0.62196962 0.6621686  0.        ]
[0.03694583 0.0751476  0.0561765  0.02454007 0.06001223 0.11376774
 0.06320573 0.         0.09978045 0.04474961 0.09366655 0.05675734
 0.06251946 0.06243843 0.05521486 0.        ]
0
1
2
3
4
kmeans Planaria 0.25
[0.1094677  0.08392652 0.06564308 0.07121494 0.14137445 0.49078894
 0.60458232 0.        ]
[0.05735728 0.05240663 0.03962353 0.03340413 0.08359794 0.09572195
 0.07848155 0.        ]
0
1
2
3
4
GMM Planaria 0.25
[0.11752288 0.09911282 0.10224634 0.08153011 0.10148416 0.53319737
 0.63040177 0.        ]
[0.05577725 0.09149375 0.07488189 0.06420558 0.05194958 0.10599617
 0.06741278 0.        ]
0
1
2
3
4
hmodel Planaria 0.25
[0.06918064 0.10133851 0.0611149  0.0871835  0.14320386 0.49250395
 0.6048885  0.         0.08112467 0.09219448 0.05571711 0.07501434
 0.10643857 0.52145696 0.62667302 0.        ]
[0.03649597 0.06999374 0.03952834 0.0466405  0.09149354 0.12052082
 0.09597864 0.         0.04557932 0.05702176 0.05764204 0.04595489
 0.05483737 0.12469103 0.07238064 0.        ]
0
1
2
3
4
kmeans Planaria 0.5
[0.04565694 0.03574003 0.03865656 0.0294761  0.02604219 0.42087562
 0.59880147 0.        ]
[0.02652637 0.01333034 0.02445874 0.00999313 0.0072239  0.02158235
 0.02454187 0.        ]
0
1
2
3
4
GMM Planaria 0.5
[0.04674722 0.05415911 0.03150493 0.03382973 0.04323646 0.49231108
 0.63100672 0.        ]
[0.02488808 0.02900049 0.02022584 0.02578773 0.02354071 0.02418591
 0.02945158 0.        ]
0
1
2
3
4
hmodel Planaria 0.5
[0.03628803 0.05243061 0.05873631 0.03788776 0.03649853 0.3901988
 0.53324353 0.         0.03447259 0.05131211 0.06598721 0.04185992
 0.02343398 0.40788862 0.54396415 0.        ]
[0.02252174 0.02192883 0.02497152 0.03828196 0.03005277 0.06028023
 0.05979336 0.         0.01677533 0.02603093 0.04548251 0.03023235
 0.02711862 0.09496769 0.08029022 0.        ]
proportion_u = 0.5  # 0.1, 0.25, 0.5
#'binary4'  # 'binary_6'  # Planaria, Paul, binary_6
dataset= 'binary4'
PATH = os.getcwd()
path_file_abs = PATH
random.seed = 1312
method = 'hGMM'
all_results = []
for dataset in ['half7','binary4','Paul', 'Planaria']:
    for proportion_u in [0.1]:
        for method in ['kmeans','GMM', 'hmodel']:
            all_results_t = []
            for t in range(5):
                print(t)
                path_data = PATH + '/datasets/'+str((dataset))+'/'
                (X, X_train, y_train, X_test, y_test,
                 X_s_train, X_s_test, y_s_train, y_s_test,
                 X_u_train, X_u_test, y_u_train, y_u_test,
                 set_y_s, set_y_u, C, matrix_parents, matrix_ascendant_descendant) = load_all_data(PATH=PATH, dataset=dataset, t=t, proportion_u=proportion_u)
                Xs , Xu = torch.cat((X_s_train, X_s_test), dim=0), torch.cat((X_u_train, X_u_test), dim=0)
                ys, yu = y_s_train + y_s_test, y_u_train + y_u_test
                d, c = X.shape[1], C.shape[0],
                set_y = list(range(c))
                n_components = c
                results_cv = CV_gridsearch(method=method,
                                           X_s_train=X_s_train,
                                           y_s_train=y_s_train,
                                           X_u_train=X_u_train,
                                           y_u_train=y_u_train,
                                           C=C,
                                           matrix_parents=matrix_parents,
                                           matrix_ascendant_descendant=matrix_ascendant_descendant)
                result_mean_cv = np.mean(results_cv, axis=0)
                best_hyperparameters_by_crit = result_mean_cv.argmax(axis=0)
                array_test = TEST(method=method,
                                  liste_hyperparams=best_hyperparameters_by_crit,
                                  X_s_train=X_s_train,
                                  y_s_train=y_s_train,
                                  X_u_train=X_u_train,
                                  y_u_train=y_u_train,
                                  X_s_test=X_s_test,
                                  y_s_test=y_s_test,
                                  X_u_test=X_u_test,
                                  y_u_test=y_u_test,
                                  C=C,
                                  matrix_parents=matrix_parents,
                                  matrix_ascendant_descendant=matrix_ascendant_descendant)
                all_results_t.append(array_test)
                #print('T : ', t, np.diag(array_test))
            array_results = np.array([all_results_t[i].tolist()[0] for i in range(5)])
            print(method, dataset, proportion_u)
            print(array_results.mean(axis=0))
            print(array_results.std(axis=0))
            all_results.append(all_results_t)
            np.save(PATH+'/'+str(method)+'_'+str(dataset)+'_'+str(proportion_u),all_results[-1])
0
1
2
3
4
kmeans half7 0.1
[0.13333333 0.50416667 0.50416667 0.65833333 0.57083333 0.6875
 0.63519442 0.        ]
[0.12541597 0.27335366 0.27335366 0.22306265 0.23033792 0.19764235
 0.23475846 0.        ]
0
1
2
3
4
GMM half7 0.1
[0.30416667 0.47083333 0.48333333 0.5        0.4875     0.775
 0.68204339 0.        ]
[0.15623611 0.32075215 0.32042723 0.30476539 0.32210247 0.16319297
 0.17343733 0.        ]
0
1
2
3
4
hmodel half7 0.1
[0.7        0.49583333 0.625      0.7        0.57083333 0.87916667
 0.71348098 0.         0.7        0.49583333 0.625      0.7
 0.57083333 0.87916667 0.71348098 0.        ]
[0.2453031  0.30686588 0.34485303 0.2453031  0.2340762  0.08477912
 0.16190341 0.         0.2453031  0.30686588 0.34485303 0.2453031
 0.2340762  0.08477912 0.16190341 0.        ]
0
1
2
3
4
kmeans binary4 0.1
[0.30833333 0.53333333 0.45       0.425      0.45       0.76666667
 0.70799844 0.        ]
[0.21505813 0.19965248 0.10341395 0.26273138 0.10341395 0.12247449
 0.03922255 0.        ]
0
1
2
3
4
GMM binary4 0.1
[0.35833333 0.70833333 0.55833333 0.44166667 0.55833333 0.73333333
 0.68898534 0.        ]
[0.33082389 0.19184774 0.16372402 0.25630927 0.16372402 0.15723302
 0.10017782 0.        ]
0
1
2
3
4
hmodel binary4 0.1
[0.84166667 0.70833333 0.725      0.58333333 0.725      0.85833333
 0.81706777 0.         0.84166667 0.70833333 0.725      0.58333333
 0.725      0.85833333 0.81706777 0.        ]
[0.161159   0.25685058 0.2535854  0.23422449 0.2535854  0.14092945
 0.14331491 0.         0.161159   0.25685058 0.2535854  0.23422449
 0.2535854  0.14092945 0.14331491 0.        ]
0
1
2
3
4
kmeans Paul 0.1
[0.67142857 0.92857143 0.92857143 0.72857143 0.67142857 0.92857143
 0.8194199  0.        ]
[0.41796397 0.14285714 0.14285714 0.38966233 0.41796397 0.14285714
 0.3611602  0.        ]
0
1
2
3
4
GMM Paul 0.1
[0.67142857 0.92857143 0.92857143 0.72857143 0.67142857 0.92857143
 0.8194199  0.        ]
[0.41796397 0.14285714 0.14285714 0.38966233 0.41796397 0.14285714
 0.3611602  0.        ]
0
1
2
3
4
hmodel Paul 0.1
[0.64337662 0.84337662 0.84337662 0.82519481 0.75662338 0.84337662
 0.62501917 0.         0.59584416 0.8587013  0.8587013  0.80415584
 0.7412987  0.8587013  0.65321731 0.        ]
[0.36842084 0.19591648 0.19591648 0.22480906 0.30072449 0.19591648
 0.46095643 0.         0.38661568 0.17317957 0.17317957 0.2571906
 0.31691122 0.17317957 0.42495452 0.        ]
0
1
2
3
4
kmeans Planaria 0.1
[0.14199794 0.20728338 0.18992754 0.23290224 0.27848808 0.4774747
 0.50812772 0.        ]
[0.09474386 0.1532249  0.13365307 0.08724449 0.12976619 0.10276143
 0.06323708 0.        ]
0
1
2
3
4
GMM Planaria 0.1
[0.17149059 0.20204882 0.25078066 0.2041196  0.16474397 0.62523734
 0.58038899 0.        ]
[0.07333188 0.24484296 0.2208496  0.03072188 0.06020114 0.09617511
 0.08874665 0.        ]
0
1
2
3
4
hmodel Planaria 0.1
[0.26357769 0.2440937  0.28780741 0.22832047 0.24130991 0.56114644
 0.55913751 0.         0.16955379 0.12544118 0.16245979 0.17326966
 0.22365835 0.59486693 0.54703995 0.        ]
[0.11134384 0.11632934 0.02391884 0.15548043 0.1217699  0.1343089
 0.06011851 0.         0.13293359 0.08509628 0.08147987 0.07974768
 0.19274509 0.14367426 0.14135456 0.        ]
















 0
1
2
3
4
kmeans binary6 0.1
[0.09583333 0.14583333 0.175      0.19166667 0.24166667 0.50208333
 0.65535852 0.        ]
[0.09578803 0.07306532 0.07551904 0.04299952 0.10404159 0.07778398
 0.07317853 0.        ]
0
1
2
3
4
kmeans binary6 0.25
[0.04193548 0.05483871 0.06935484 0.11451613 0.05725806 0.37419355
 0.6182089  0.        ]
[0.03098286 0.02127565 0.00933535 0.02112226 0.02411277 0.0283293
 0.02780207 0.        ]
0
1
2
3
4
kmeans binary6 0.5
[0.0202381  0.03095238 0.03611111 0.06507937 0.03174603 0.2984127
 0.61627712 0.        ]
[0.01014818 0.01264871 0.01382639 0.01680779 0.00955682 0.00716487
 0.00855753 0.        ]
0
1
2
3
4
GMM binary6 0.1
[0.08333333 0.23333333 0.19375    0.20208333 0.23333333 0.55416667
 0.68319014 0.        ]
[0.04419417 0.10090734 0.08604949 0.06705615 0.14472795 0.10021678
 0.07031443 0.        ]
0
1
2
3
4
GMM binary6 0.25
[0.04274194 0.05       0.06854839 0.13064516 0.03951613 0.45725806
 0.68547676 0.        ]
[0.02545118 0.02947688 0.00721312 0.03602953 0.01538612 0.0472721
 0.03326447 0.        ]
0
1
2
3
4
GMM binary6 0.5
[0.01587302 0.02420635 0.025      0.06428571 0.01746032 0.36785714
 0.66671503 0.        ]
[0.01419726 0.00384736 0.00526448 0.01246057 0.00291606 0.01140485
 0.00487539 0.        ]
0
1
2
3
4
hmodel binary6 0.1
[0.58333333 0.29375    0.24166667 0.50625    0.21875    0.64583333
 0.72277144 0.         0.57916667 0.26666667 0.24166667 0.50416667
 0.22083333 0.65       0.72240797 0.        ]
[0.05432669 0.10021678 0.025      0.09142962 0.0817559  0.08564502
 0.06966467 0.         0.0557462  0.11460227 0.025      0.08999421
 0.0842141  0.08270597 0.0702091  0.        ]
0
1
2
3
4
hmodel binary6 0.25
[0.35564516 0.09596774 0.07822581 0.29919355 0.09112903 0.43870968
 0.66946513 0.         0.35564516 0.0983871  0.07822581 0.30322581
 0.07016129 0.43870968 0.6711459  0.        ]
[0.02542562 0.05102997 0.01918609 0.05454141 0.03602953 0.02477789
 0.02127961 0.         0.0209367  0.05461291 0.02519435 0.05601211
 0.04037094 0.02411277 0.0214038  0.        ]
0
1
2
3
4
hmodel binary6 0.5
[0.19166667 0.06468254 0.03769841 0.14365079 0.02301587 0.31031746
 0.63200743 0.         0.19047619 0.06388889 0.04126984 0.14404762
 0.0281746  0.31111111 0.63262548 0.        ]
[0.01759508 0.03171129 0.02276132 0.01319705 0.00296957 0.0128341
 0.0076586  0.         0.01500609 0.0336109  0.02164063 0.02056612
 0.00423694 0.01288308 0.00847762 0.        ]
0






























######################## OLD TABLE :






% \begin{table}[h]
%     \centering
%     \begin{tabular}{llc||cccccc} 
%     \toprule
%            &&&  \multicolumn{6}{c}{Methods}\\ 
%  Metric& Dataset&  prop u&  h-Phi& Phi & h-GMM& GMM & Autonovel&\\ 
%  \midrule
%     ACC&Myeloid Progenitor&0.1&  0.53±0.14 &  0.46±0.22 &  0.73±0.14 &  &  0.48±0.21 \\
%            &&0.25&  0.48±0.09 &  0.37±0.04 &  0.33±0.07 &  0.31±0.6 & 0.51±0.08 & \\ 
%            &&0.5&  0.45±0.03 &  0.35±0.04 &  0.19±0.01 &  0.18±0.00 &  0.38±0.10 & \\ 
%         &S. mediterranea&0.1&  0.66±0.0 &  0.63±0.07 &  0.36±0.12 &  &  0.46±0.10 & \\ 
%            &&0.25&  0.61±0.10 &  0.62±0.04 &  0.33±0.01 &  0.34±nan &  & \\ 
%            &&0.5&  0.61±0.04 &  0.64±0.0 &  0.29±0.03 &  0.28±0.03 &  & \\ 
%         &Binary-4&0.1&  0.60±0.08 & 0.67 ±0.15  & 0.47 ±0.07&&& \\ 
%            &&0.25& 0.50 ±0.06 &  0.60 ±0.08    & 0.44±0.05&&& \\ 
%            &&0.5& 0.54±0.06&  0.59 ± 0.02           & 0.38 ±0.04&&& \\ 
%              & & & & & & & &\\ 
%  NMI& Myeloid Progenitor& 0.1& 0.39±0.26 & 0.31±0.15 & 0.00±0.01 & & 0.32±0.14 &\\ 
%          & & 0.25& 0.55±0.05 & 0.51±0.04 & 0.01±0.01 & 0.04±0.04 & 0.46±0.07 &\\ 
%          & & 0.5& 0.52±0.03 & 0.49±0.02 & 0.01±0.00 & 0.00±0.00 & 0.31±0.03 &\\ 
%      & S. mediterranea& 0.1& 0.72±0.11 & 0.71±0.08 & 0.44±0.12 & & 0.50±0.13 &\\ 
%          & & 0.25& 0.75±0.05 & 0.75±0.05 & 0.42±0.02 & 0.44±nan & &\\ 
%                    &&0.5&  0.73±0.03 &  0.76±0.02 &  0.43±0.02 &  0.38±0.03 &  & \\ 
%          &Binary-4&0.1& 0.66±0.10&   0.68 ± 0.14 &  0.50 ±0.08 &   &    & \\ 
%            &&0.25& 0.68±0.04&   0.72 ±0.05  &0.58±0.05&&& \\ 
%            &&0.5& 0.73 ±0.04 &     0.71 ±0.04   & 0.57 ±0.03&&& \\ 
%            \bottomrule
%     \end{tabular}
%     \caption{Comparison of methods on clustering criteria}
%     \label{ncd-comparison}
% \end{table}




% \begin{table}[h]
%     \centering
%     \begin{tabular}{llc||cc|ccc} 
%         \toprule
%            &&&  \multicolumn{5}{c}{Methods}\\ 
%  & Dataset& & \multicolumn{2}{c}{hierarchique}& \multicolumn{3}{c}{Baseline}\\ 
%  Metric& |Y|&   |Yu |&  h-Phi& h-GMM& kmeans& GMM&Autonovel\\ 
%  \midrule
%     Acc&Branches-7&3& 0.94 ± 0.07& & 0.74 ± 0.2& 0.56 ± 0.04& 072 ± 0.14\\ 
%            &36&9& 0.78 ± 0.1& & 0.61 ± 0.04& 0.69 ± 0.06& 0.66 ± 0.07\\ 
%            &&18& 0.60 ±0.03& & 0.50 ± 0.05&  0.56 ± 0.05&\\ 
%         &Binary-4&3& 0.95  ± 0.08& & 0.78 ± 0.13&  0.87 ± 0.07&\\ 
%            &31&7& 0.74 ± 0.04& & 0.60 ± 0.10& 0.68 ± 0.06& \\ 
%            &&15& 0.62 ± 0.06& & 0.50 ± 0.04&  0.56 ± 0.04&\\ 
%         &Myeloid Progenitor&2&  0.83 ±  0.20& &  0.82 ± 0.2&  0.73 ± 0.21&\\ 
%            &26&6& 0.60 ±0.08& & 0.69 ±0.12&  0.67 ±0.11&\\ 
%            &&13&   0.48 ±  0.10& & 0.60 ±0.03&  0.56 ±0.04&\\ 
%                      &S. mediterranea&5&    0.54 ±0.14& & 0.48 ±0.14& 0.58 ±0.18&\\ 
                 
%            &51&12&  0.67 ± 0.15& &  0.55 ± 0.08&  0.6 ± 0.09&\\ 
%            &&25&   0.48 ±0.14& & 0.47 ± 0.04&  0.53 ± 0.03&\\
%            \bottomrule

%     \end{tabular}
%     \caption{\textbf{Comparison of methods on ACC}}
%     \label{acc-comparison_old}
% \end{table}










% \begin{table}[h]
%     \centering
%     \begin{tabular}{llc||cc|ccc} 
%         \toprule
%            &&&  \multicolumn{5}{c}{Methods}\\ 
%  & Dataset& & \multicolumn{2}{c}{hierarchique}& \multicolumn{3}{c}{Baseline}\\ 
%  Metric& |Y|&   |Yu |&  h-Phi& h-GMM& kmeans& GMM&Autonovel\\ 
%  \midrule
%     NMI&Branches-7&3& 0.9 ± 0.1& & 0.76 ± 0.19& 0.59 ± 0.08& 0.56 ±0.12\\ 
%            &36&9& 0.79 ± 0.09& &  0.73 ± 0.06& 0.76 ± 0.06& 0.72 ± 0.06\\ 
%            &&18& 0.75 ±0.03& & 0.70 ±0.04&  0.73 ± 0.04&\\ 
%         &Binary-4&3& 0.92  ±0.11& & 0.71 ±0.07&  0.76 ± 0.13&\\ 
%            &31&7& 0.78 ± 0.03& & 0.71 ±0.06& 0.73 ± 0.05& \\ 
%            &&15& 0.75  ± 0.02& & 0.70 ±0.03&  0.74 ±0.02&\\ 
%         &Myeloid Progenitor&2&  0.61 ±0.46& & 0.61 ± 0.47&   0.4 ± 0.48&\\ 
%            &26&6& 0.48 ± 0.13& & 0.54 ± 0.13&  0.52 ± 0.15&\\ 
%            &&13&   0.46 ±  0.10& & 0.60 ±0.02&   0.53 ± 0.06&\\ 
%                      &S. mediterranea&5&    0.48 ±0.16& & 0.50 ±0.13& 0.59 ±0.14&\\ 
                 
%            &51&12& 0.75 ± 0.17& & 0.68 ± 0.04&  0.74 ± 0.05&\\ 
%            &&25&   0.64 ± 0.13& & 0.66 ± 0.03&  0.71 ± 0.02&\\
%            \bottomrule

%     \end{tabular}
%     \caption{\textbf{Comparison of methods on NMI }}
%     \label{nmi-comparion-old}
% \end{table}





% \subsection{Mapping cluster to label}


% \begin{table}[h]
%     \centering
%     \begin{tabular}{llc||cc|cc} 
%         \toprule
%            &&&  \multicolumn{4}{c}{Methods}\\ 
%  & Dataset& & \multicolumn{2}{c}{1-step approach}& \multicolumn{2}{c}{k-MEANS + Algo mapping}\\ 
%  M|Y|Dataset&  |Yu |&  h-Phi& h-GMM& BFS   & Supervision first\\ 
%  \midrule
%     f1&Branches-7&3& 0.94 ± 0.07& & 0.7 ± 0.25&  0.64 ± 0.28\\ 
%            &36&9& 0.74 ± 0.13& &  0.35 ± 0.07&  0.28 ± 0.09\\ 
%            &&18& 0.47 ± 0.09& & 0.10 ±0.03&  0.16 ±0.04\\ 
%         &Binary-4&3& 0.95  ±0.08& & 0.45 ±0.25&  0.60 ± 0.21\\ 
%            &31&7& 0.68  ±0.07& & 0.23±0.06&  0.33 ±0.15\\ 
%            &&15& 0.41  ± 0.11& & 0.12 ±0.04&  0.18 ±0.05\\ 
%         &Myeloid Progenitor&2&  0.58 ± 0.38& & 0.62 ± 0.36&  0.82 ± 0.2\\ 
%            &26&6& 0.13 ± 0.18& & 0.28 ± 0.17&  0.10 ±0.11\\ 
%            &&13&   0.15 ±  0.06& & 0.15 ±0.19&  0.15 ±0.04\\ 
%                      &S. mediterranea&5&    0.29 ± 0.15& & 0.28 ± 0.14& 0.23 ±0.09\\ 
                 
%            &51&12& 0.06 ±0.04& & 0.06 ±0.04&  0.07 ±0.03\\ 
%            &&25&   0.04 ± 0.01& & 0.08 ± 0.01&  0.03 ± 0.02\\
%            \bottomrule

%     \end{tabular}
%     \caption{\textbf{Comparison of methods on classification metric}}
%     \label{f1-comparison_old}
% \end{table}






% \subsubsection{Algorithm: loop over edges} 

% \paragraph{} The main idea is to perform a minimum spanning tree by incorporating supervised information and hierarchical label information.  We are inspired by the Kruskal algorithm, which performs a minimum spanning tree by selecting the shortest edges on a graph and checking that it does not create a cycle. Here, we introduced an additional step in the algorithm, the identification of nodes, since we want to create a minimum spanning tree that matches the label hierarchy (tree-based form).  


% \paragraph{Identification step}: in some specific cases, the attribution of an edges makes the identification to certain nodes of the tree. For example, if an edge is created between a leaf node and the grandparents of the leaf node then, 

% \begin{algorithm}[h!]
% \caption{Hierarchical extension of the Kruskal algorithm \textcolor{red}{A reformuler} }
% \label{algo:greedy:edges}
% \Data{ }
% $Z_s, Z_u$, supervised clusters, unsupervised clusters. \\ 
% %$C$ the pairwise distance label matrix. \\
% % $G = (V,E)$, the Tree associated to $C$ \\
% %matrix sh-path and number of label \\
% solution = \{ \} \\
% \Initialize{} 
% Compute the pairwise distances between all clusters \\
% Assign supervised cluster to supervised node and remove all obvious edges \\
% $G = (V,E)$
% \For{edges in $\mathcal{T}_{u}$ }{
% /*  Select shortest edges */ \\
% /* No cycle condition  */ \\
% \If{no cycle}{
% /* Check if select edges is possible with a tree based graph  */ \\

% \If{Tree form agreement}{
% /* Identification step between cluster and nodes */ \\
% \If{obvious node}{
% update all obvious edges \\
% remove all updated edges of the main loop 
%   }
% /* Update tree information  */ \\
% }
%   }
%  }
% \end{algorithm}


% %comments
% \paragraph{} Discussion on convergence of algorithm


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%